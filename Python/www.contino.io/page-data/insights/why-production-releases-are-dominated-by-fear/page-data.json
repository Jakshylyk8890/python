{"componentChunkName":"component---src-templates-article-js","path":"/insights/why-production-releases-are-dominated-by-fear","result":{"data":{"sanityArticle":{"publishedAt":"2 June 2017","publishedAtRaw":"2017-06-02","title":"Why Production Releases Are Dominated By *Fear*: The Story of a Completely Fictional Airline","seoTitle":"Why Production Releases Are Dominated By *Fear*: The Story of a Completely Fictional Airline","seoDescription":"Recent systemic failures of a certain airline remind us why releasing to production can be so scary - the stakes are high! But does it have to be this way?","slug":{"current":"why-production-releases-are-dominated-by-fear"},"heroImage":{"alt":"Why Production Releases Are Dominated By *Fear*: The Story of a Completely Fictional Airline","asset":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAcCBAUG/8QAJBAAAgIBAwIHAAAAAAAAAAAAAQIDBAAFBhEhYxIVIkFy0eH/xAAXAQADAQAAAAAAAAAAAAAAAAABAgME/8QAGhEBAAIDAQAAAAAAAAAAAAAAAQACAwQxE//aAAwDAQACEQMRAD8A62Pel6PlfMYwR148I6ZDUd7atFXWatbQxye5QA4qLjpHZL8Sknufma6smraVxKHjWIekK+GuVWTK14S5qO6dVmtM5u1yfhhi0uvFHZdQs3A7p+sM0GwhyJ5E/9k=","aspectRatio":1.550387596899225,"src":"https://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg","srcSet":"https://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg?w=300&h=194&fit=crop 300w,\nhttps://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg?w=600&h=387&fit=crop 600w,\nhttps://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg 1200w","srcWebp":"https://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg?fm=webp","srcSetWebp":"https://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg?w=300&h=194&fit=crop&fm=webp 300w,\nhttps://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg?w=600&h=387&fit=crop&fm=webp 600w,\nhttps://cdn.sanity.io/images/hgftikht/production/483638876cb07ab8f1e4ffabe5efd03c381f20e4-1200x774.jpg?fm=webp 1200w","sizes":"(max-width: 1200px) 100vw, 1200px"}}},"_rawBody":[{"_key":"f0703611741f","_type":"block","children":[{"_key":"f0703611741f0","_type":"span","marks":[],"text":"Releasing to production is increasingly encumbered by "},{"_key":"f0703611741f1","_type":"span","marks":["em"],"text":"fear"},{"_key":"f0703611741f2","_type":"span","marks":[],"text":"."}],"markDefs":[],"style":"normal"},{"_key":"80e5b69aae82","_type":"block","children":[{"_key":"80e5b69aae820","_type":"span","marks":[],"text":"Universities "},{"_key":"80e5b69aae821","_type":"span","marks":["em"],"text":"fear"},{"_key":"80e5b69aae822","_type":"span","marks":[],"text":" that rolling out the latest image will cause "},{"_key":"80e5b69aae823","_type":"span","marks":["60e9af841b75"],"text":"every computer in the network to reformat itself spontaneously"},{"_key":"80e5b69aae824","_type":"span","marks":[],"text":"."}],"markDefs":[{"_key":"60e9af841b75","_type":"link","href":"https://thenextweb.com/shareables/2014/05/16/emory-university-server-accidentally-sends-reformat-request-windows-pcs-including"}],"style":"normal"},{"_key":"b4f9a90c013f","_type":"block","children":[{"_key":"b4f9a90c013f0","_type":"span","marks":[],"text":"Retail companies "},{"_key":"b4f9a90c013f1","_type":"span","marks":["em"],"text":"fear"},{"_key":"b4f9a90c013f2","_type":"span","marks":[],"text":" that their next system update will "},{"_key":"b4f9a90c013f3","_type":"span","marks":["f0b3003e9b52"],"text":"take down their entire point-of-sale network and lose them millions of dollars in sales"},{"_key":"b4f9a90c013f4","_type":"span","marks":[],"text":"."}],"markDefs":[{"_key":"f0b3003e9b52","_type":"link","href":"https://www.geekwire.com/2015/starbucks-lost-millions-in-sales-because-of-a-system-refresh-computer-problem/"}],"style":"normal"},{"_key":"2ed348be9cac","_type":"block","children":[{"_key":"2ed348be9cac0","_type":"span","marks":[],"text":"Most recently, airlines "},{"_key":"2ed348be9cac1","_type":"span","marks":["em"],"text":"fear"},{"_key":"2ed348be9cac2","_type":"span","marks":[],"text":" that a few faulty IT processes will "},{"_key":"2ed348be9cac3","_type":"span","marks":["619999feb668"],"text":"come to a head and cost the company hundreds of millions of dollars by rendering core reservation systems unavailable"},{"_key":"2ed348be9cac4","_type":"span","marks":[],"text":"."}],"markDefs":[{"_key":"619999feb668","_type":"link","href":"http://www.independent.co.uk/news/uk/home-news/british-airways-it-meltdown-airline-millions-heathrow-gatwick-a7759861.html"}],"style":"normal"},{"_key":"2dcc93f1d573","_type":"block","children":[{"_key":"2dcc93f1d5730","_type":"span","marks":[],"text":"Regardless of the story, the outcome is the same: the more complex IT infrastructure becomes, the more process-driven its maintenance becomes as well. More processes introduce more opportunities for error. More errors create more process as a remediation measure. More process means more complexity, and so on."}],"markDefs":[],"style":"normal"},{"_key":"a2b379aa04ea","_type":"block","children":[{"_key":"a2b379aa04ea0","_type":"span","marks":[],"text":"While it sometimes isn’t possible to reduce the complexity of a system, it *is* possible to automate as much of that process as possible in unified and accessible ways. Migrating the sparsely-located runbooks and scripts outlining the creation, maintenance and destruction of infrastructure into code within a single codebase is the easiest and fastest way of doing this. This post will explain why."}],"markDefs":[],"style":"normal"},{"_key":"4acd0ab46122","_type":"block","children":[{"_key":"4acd0ab461220","_type":"span","marks":[],"text":"The Scenario"}],"markDefs":[],"style":"normal"},{"_key":"c9cba0692a02","_type":"block","children":[{"_key":"c9cba0692a020","_type":"span","marks":[],"text":"You are an engineering manager for one of the world’s largest airlines. The systems powering your operation are vast and complex: global distribution system integrations (GDS) that ensure that your flights are at the top of the list on Google Flights or Expedia, passenger service systems (PSS) that ensure a smooth experience for your passengers from origin to destination, crew management systems that keep the scheduling and operations of your flight crews in top shape; the list goes on. You are also responsible for the vast amount of infrastructure that most take for granted: the API gateways for your mobile app, the many JBoss or Tomcat servers powering the thousands of pages on your website, the F5s, Palo Altos and Bluecoat appliances that keep the load on your web servers evenly distributed and secure from outside traffic, etc. Then there are the regulatory obligations from the FAA, EASA, CISA and all sort’s of A’s that your code and systems need to adhere to (and that you can’t forget about)."}],"markDefs":[],"style":"normal"},{"_key":"76901d82d352","_type":"block","children":[{"_key":"76901d82d3520","_type":"span","marks":[],"text":"You have a tough job. Your job is made even tougher whenever a change needs to be made anywhere within this web of devices."}],"markDefs":[],"style":"normal"},{"_key":"46a8fa8cd9ea","_type":"block","children":[{"_key":"46a8fa8cd9ea0","_type":"span","marks":[],"text":"Why? Several reasons."}],"markDefs":[],"style":"normal"},{"_key":"5d24253b6f15","_type":"block","children":[{"_key":"5d24253b6f150","_type":"span","marks":[],"text":"Engineers on your teams need to know where the documents are that describe how this change works. They might have tried the change in their lab, but because of how divergent their lab’s setup is from production, there is no real guarantee that the change will work as advertised. Some parts of documentation are outdated or missing, and the engineer that wrote the latest revision is no longer with the company. Another engineer wrote some scripts to automate this change some time ago, but that code hasn’t been tested, and given that many high-impact changes happen during the weekends, the change window isn’t a good time to find out how well it holds up. Your change also needs the help of networking and security to get done, but since every team operates largely independently of each other, much ticket passing will need to be made to do the prerequisite work for your change."}],"markDefs":[],"style":"normal"},{"_key":"d4a11b77fdc2","_type":"block","children":[{"_key":"d4a11b77fdc20","_type":"span","marks":[],"text":"From what I’ve seen, this is usually the anatomy of how a change that takes minutes in practice turns into a change that takes days. Lagging change approvals from busy managers that are drowning in a sea of change approval requests turn these days into weeks. Feature code deployments dependent on this change begin to queue, slowing them down in the process. Product managers and business development grow upset by “our” inability to push changes fast enough, and lose trust in the process."}],"markDefs":[],"style":"normal"},{"_key":"0cdbe8a1d683","_type":"block","children":[{"_key":"0cdbe8a1d6830","_type":"span","marks":[],"text":"The worst part? If that change fails, then we roll back (or try to roll back) and restart the entire process all over again. Except this time, the upper management responsible for answering to shareholders will be looking for names. Consequently, the fear of touching production gets even greater and "},{"_key":"0cdbe8a1d6831","_type":"span","marks":["em"],"text":"nothing ever changes"},{"_key":"0cdbe8a1d6832","_type":"span","marks":[],"text":"."}],"markDefs":[],"style":"normal"},{"_key":"ff168df157c4","_type":"block","children":[{"_key":"ff168df157c40","_type":"span","marks":[],"text":"It doesn’t have to be this way. This is exactly the problem that DevOps was meant to solve."}],"markDefs":[],"style":"normal"},{"_key":"15ae6932c09d","_type":"block","children":[{"_key":"15ae6932c09d0","_type":"span","marks":[],"text":"The Solution? Infrastructure as Code"}],"markDefs":[],"style":"normal"},{"_key":"e7464c5357ef","_type":"block","children":[{"_key":"e7464c5357ef0","_type":"span","marks":["em"],"text":"Infrastructure-as-code"},{"_key":"e7464c5357ef1","_type":"span","marks":[],"text":" is a paradigm in which servers, networking and security devices are managed exactly like software features. The creation, administration and decommisioning of servers, routers, switches, storage devices, firewalls, load balancers, or any other appliances are written entirely in an easy-to-read and "},{"_key":"e7464c5357ef2","_type":"span","marks":["em"],"text":"domain-specific language"},{"_key":"e7464c5357ef3","_type":"span","marks":[],"text":", tested and documented using the "},{"_key":"e7464c5357ef4","_type":"span","marks":["7d64eb74828d"],"text":"software testing pyramid"},{"_key":"e7464c5357ef5","_type":"span","marks":[],"text":" and deployed via continuous delivery pipelines."}],"markDefs":[{"_key":"7d64eb74828d","_type":"link","href":"https://watirmelon.blog/2011/06/10/yet-another-software-testing-pyramid/"}],"style":"normal"},{"_key":"7a1533b873fb","_type":"block","children":[{"_key":"7a1533b873fb0","_type":"span","marks":[],"text":"There are several tools on the market that accomplish this goal. For the provisioning side of the equation, Terraform is a tool by HashiCorp that provides a domain-specific language for provisioning infrastructure components. Configuration management tools solve the "},{"_key":"7a1533b873fb1","_type":"span","marks":["em"],"text":"configuration"},{"_key":"7a1533b873fb2","_type":"span","marks":[],"text":" that is required post-provisioning by providing domain specific languages and helper tools that express how infrastructure components should be configured. The most popular tools on the market are currently "},{"_key":"7a1533b873fb3","_type":"span","marks":["strong"],"text":"Chef"},{"_key":"7a1533b873fb4","_type":"span","marks":[],"text":" by OpsCode, "},{"_key":"7a1533b873fb5","_type":"span","marks":["strong"],"text":"Puppet"},{"_key":"7a1533b873fb6","_type":"span","marks":[],"text":" by Puppet Labs, "},{"_key":"7a1533b873fb7","_type":"span","marks":["strong"],"text":"Ansible"},{"_key":"7a1533b873fb8","_type":"span","marks":[],"text":" by Red Hat and "},{"_key":"7a1533b873fb9","_type":"span","marks":["strong"],"text":"Salt"},{"_key":"7a1533b873fb10","_type":"span","marks":[],"text":" by SaltStack."}],"markDefs":[],"style":"normal"},{"_key":"4fb996723805","_type":"block","children":[{"_key":"4fb9967238050","_type":"span","marks":[],"text":"This post will explain what a mature implementation of a code-driven infrastructure looks like. I will use Terraform and Chef as examples for what our fictional world-class airline would look like in this ideal state. Containers and container orchestration as well as implementing continuous delivery pipelines will be covered in separate posts, as they are heavy topics that warrant their own posts."}],"markDefs":[],"style":"normal"},{"_key":"32a8bea71b59","_type":"block","children":[{"_key":"32a8bea71b590","_type":"span","marks":[],"text":"A Model for an Ideal Code-Driven Infrastructure"}],"markDefs":[],"style":"normal"},{"_key":"a4e8b24de36c","_type":"block","children":[{"_key":"a4e8b24de36c0","_type":"span","marks":[],"text":"Moving your teams’ runbook documents and scripts to a single codebase composed of Terraform provisioning configurations and configuration management code by way of Chef cookbooks or Puppet manifests solve for these problems in three key ways."}],"markDefs":[],"style":"normal"},{"_key":"a55b56a7f290","_type":"block","children":[{"_key":"a55b56a7f2900","_type":"span","marks":[],"text":"1. Clearly defined environments and environment relationships"}],"markDefs":[],"style":"h2"},{"_key":"018fcdcdfaed","_type":"block","children":[{"_key":"018fcdcdfaed0","_type":"span","marks":[],"text":"Terraform "},{"_key":"018fcdcdfaed1","_type":"span","marks":["em"],"text":"modules"},{"_key":"018fcdcdfaed2","_type":"span","marks":[],"text":" enable engineers and developers to define reusable pieces of infrastructure. Modules can also contain other modules to express dependency relationships. These can be used to define an environment is an easily-readable and easily-consumable way."}],"markDefs":[],"style":"normal"},{"_key":"d3df32ccd3eb","_type":"block","children":[{"_key":"d3df32ccd3eb0","_type":"span","marks":[],"text":"Let’s say that an engineer wanted to migrate a runbook that creates an environment for a business application. This application is comprised of a web tier, an application tier and a persistence tier. It also interacts with your enterprise load balancer and IPAM appliances. Using pseudocode, this Terraform module would look something like the below:"}],"markDefs":[],"style":"normal"},{"_key":"93afcf84a029","_type":"block","children":[{"_key":"93afcf84a0290","_type":"span","marks":[],"text":"# git://path/modules/application_environment/main.tf # This is a variable that consumers of this module will need to provide. # Because it has a default value already set, this variable is optional. variable \"number_of_servers\" { description = \"The number of servers to provision within this environment.\" default = 1 } # This is an example of a mandatory variable. # If it is missing, your Terraform run will fail. variable \"ssh_key_location { description = \"The path to the SSH key to provision onto instances within this environment.\" } # Every resource can provide \"outputs\" that provide useful information about itself. # This resource will output an IP address that is # accessible through vm.web_server.ip_address resource \"vm\" \"web_server\" { Number_of_servers = ${var.number_of_servers} Vm_memory_gbs = 32 Vm_cpu_count = 4 Instance_tags = { Name = \"name_of_instance\" Group = [ \"Group_1\", \"Group_2\" ] } provisioner \"chef\" { node_name = \"web_server\" run_list = [\"base::default\",\"web_server::default\",\"ipam::registration\"] # rest of Chef settings } } # Every resource can provide \"outputs\" that provide useful information about itself. # This resource will output an IP address that is # accessible through vm.app_server.ip_address # Also, notice the 'depends_on' parameter. # This tells Terraform which resources are related to what and # applies an order in which infrastructure must be provisioned during a deployment. resource \"vm\" \"app_server\" { depends_on = [\"vm.web_server\"] Number_of_servers = ${var.number_of_servers} Vm_memory_gbs = 32 Vm_cpu_count = 4 Instance_tags = { Name = \"name_of_instance\" Group = [ \"Group_1\", \"Group_2\" ] } provisioner \"chef\" { attributes_json = <<-EOF { ssh_key_location = \"${var.ssh_key_location}\" } EOF node_name = \"app_server\" run_list = [\"base::default\",\"app_server::default\",\"ipam::registration\"] # rest of Chef settings } } resource \"vm\" \"database_server\" { depends_on = [\"vm.web_server\", \"vm.app_server\"] Number_of_servers = ${var.number_of_servers} Vm_memory_gbs = 32 Vm_cpu_count = 4 Instance_tags = { Name = \"name_of_instance\" Group = [ \"Group_1\", \"Group_2\" ] } provisioner \"chef\" { attributes_json = <<-EOF { ssh_key_location = \"${var.ssh_key_location}\" } EOF node_name = \"app_server\" run_list = [\"base::default\",\"database_server::default\",\"ipam::registration\"] # rest of Chef settings } } resource \"dns_record\" \"web_server\" { Depends_on = [\"vm.web_server\"] record_type = \"A\" Record_name = \"webserver1.example.com\" Ip_address = vm.web_server.ip_address } resource \"dns_record\" \"app_server\" { Depends_on = [\"vm.app_server\"] record_type = \"A\" Record_name = \"appserver1.example.com\" Ip_address = vm.app_server.ip_address } resource \"dns_record\" \"db_server\" { Depends_on = [\"vm.database_server\"] record_type = \"A\" Record_name = \"dbserver1.example.com\" Ip_address = vm.database_server.ip_address } # webapp.example.com Resource \"load_balancer_entry\" \"web_server\" { Depends_on = [\"vm.web_server\"] Entry_name = \"webapp\" Location = dns_record.web_server.record_name } # app-backend.example.com Resource \"load_balancer_entry\" \"app_server\" { Depends_on = [\"vm.app_server\"] Entry_name = \"app-backend\" Location = dns_record.web_server.record_name }"}],"markDefs":[],"style":"normal"},{"_key":"9db21299b3d9","_type":"block","children":[{"_key":"9db21299b3d90","_type":"span","marks":[],"text":"While this might seem like a lot of code, in practice, this will only need to be staged upon its inception. Once created, whenever an engineer wants to define a new environment, all they have to do is write:"}],"markDefs":[],"style":"normal"},{"_key":"266f8412490d","_type":"block","children":[{"_key":"266f8412490d0","_type":"span","marks":[],"text":"# main.tf module \"application_environment\" \"dev\" { source = \"git://path/modules/application_environment\" number_of_servers = 4 ssh_key_location = \"path/to/dev/key\" }"}],"markDefs":[],"style":"normal"},{"_key":"a22c6d939211","_type":"block","children":[{"_key":"a22c6d9392110","_type":"span","marks":[],"text":"in any directory, and then run "},{"_key":"a22c6d9392111","_type":"span","marks":["em"],"text":"terraform get; terraform apply"},{"_key":"a22c6d9392112","_type":"span","marks":[],"text":" to create it."}],"markDefs":[],"style":"normal"},{"_key":"2bac2c4c62c1","_type":"block","children":[{"_key":"2bac2c4c62c10","_type":"span","marks":[],"text":"No more SharePoint documented or runbooks. No more inconsistent environments."}],"markDefs":[],"style":"normal"},{"_key":"ab9010ad31dd","_type":"block","children":[{"_key":"ab9010ad31dd0","_type":"span","marks":[],"text":"There are two other advantages gained by using Terraform for this:"}],"markDefs":[],"style":"normal"},{"_key":"df889c165c12","_type":"block","children":[{"_key":"df889c165c120","_type":"span","marks":["strong"],"text":"Terraform keeps track of its state."},{"_key":"df889c165c121","_type":"span","marks":[],"text":" This allows engineers to make changes against any infrastructure component without having to redeploy an entire environment. Terraform will only reprovision what's changed and will automatically know which parameters will require a complete recreation of a component.\n\nWhat this means is this: if I change the number_of_servers to 6 instead of 4, Terraform will only deploy two additional servers instead of adding six additional servers or destroying all four existing servers and recreating six new ones. This saves a lot of time and minimizes the need for downtime.\n"}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"78922d3d36ac","_type":"block","children":[{"_key":"78922d3d36ac0","_type":"span","marks":["strong"],"text":"Terraform can tell you what will happen before it happens."},{"_key":"78922d3d36ac1","_type":"span","marks":[],"text":" If an engineer makes the above change but wants to actually confirm that two servers will be created, she can run terraform plan to get a summary of what will happen next. Terraform will then show you what will be added, removed and recreated.\n\nThis removes the chances of deploying changes blind and provides a basis from which Terraform configurations can be tested. (This is discussed in more detail in a later section.)"}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"f4142fe904a0","_type":"block","children":[{"_key":"f4142fe904a00","_type":"span","marks":[],"text":"What's more: whenever this module changes, you can see exactly what changed and by whom. Most Git servers or collaborative version control systems also enable you to apply permissions onto repositories so that you can control who can create, modify or remove modules or Terraform configurations."}],"markDefs":[],"style":"normal"},{"_key":"eb44f7fbcfd9","_type":"block","children":[{"_key":"eb44f7fbcfd90","_type":"span","marks":[],"text":"2. Natural change control through code reviews and tests"}],"markDefs":[],"style":"h2"},{"_key":"f998b1236d79","_type":"block","children":[{"_key":"f998b1236d790","_type":"span","marks":[],"text":"As mentioned earlier, in a world without infrastructure as code, changes are coordinated largely through tickets in change management software such as ServiceNow or Remedy. Additionally, testing the efficacy of a change is usually done manually in a lab (that is usually an older and scaled-down version of production with lots of ‘fixes’ here and there) or, worse, with production servers during or outside of business hours."}],"markDefs":[],"style":"normal"},{"_key":"bc295e5c753a","_type":"block","children":[{"_key":"bc295e5c753a0","_type":"span","marks":[],"text":"Testing your infrastructure becomes a lot easier in an infrastructure-as-code world for two reasons."}],"markDefs":[],"style":"normal"},{"_key":"1cf4a7e7fb00","_type":"block","children":[{"_key":"1cf4a7e7fb000","_type":"span","marks":[],"text":"Firstly, like any application source code, one can write "},{"_key":"1cf4a7e7fb001","_type":"span","marks":["em"],"text":"unit tests"},{"_key":"1cf4a7e7fb002","_type":"span","marks":[],"text":" that test the correctness of your code and serve as a "},{"_key":"1cf4a7e7fb003","_type":"span","marks":["em"],"text":"de facto"},{"_key":"1cf4a7e7fb004","_type":"span","marks":[],"text":" contract that your infrastructure must adhere to. Given this, unit tests also serve as documentation that always updates and, in a mature organization, "},{"_key":"1cf4a7e7fb005","_type":"span","marks":["em"],"text":"will always be correct"},{"_key":"1cf4a7e7fb006","_type":"span","marks":[],"text":"."}],"markDefs":[],"style":"normal"},{"_key":"be9ac9f9d2a1","_type":"block","children":[{"_key":"be9ac9f9d2a10","_type":"span","marks":[],"text":"Chef unit tests can be achieved through the ChefSpec "},{"_key":"be9ac9f9d2a11","_type":"span","marks":["e682c1b29410"],"text":"testing framework"},{"_key":"be9ac9f9d2a12","_type":"span","marks":[],"text":". While Terraform testing frameworks are still in early days, you can test your Terraform configuration code against the calculated state from a Terraform plan run. You can see an example of this approach for the tests behind infrastructure code powering carlosnunez.me, my personal domain, which you can find here: "},{"_key":"be9ac9f9d2a13","_type":"span","marks":["89cd94b01c7a"],"text":"https://github.com/carlosonunez/carlosnunez-me-infrastructure/spec"},{"_key":"be9ac9f9d2a14","_type":"span","marks":[],"text":"."}],"markDefs":[{"_key":"e682c1b29410","_type":"link","href":"https://docs.chef.io/chefspec.html"},{"_key":"89cd94b01c7a","_type":"link","href":"https://github.com/carlosonunez/carlosnunez-me-infrastructure/spec"}],"style":"normal"},{"_key":"9bd1a1637d4f","_type":"block","children":[{"_key":"9bd1a1637d4f0","_type":"span","marks":[],"text":"Secondly, when the code for your infrastructure resides in version control, you can apply the same forking and branching strategies used by application deployments to create approval gates. These gates ensure that the infrastructure defined in master is known to be valid and suitable for production workloads. The approvals between those gates are enacted through "},{"_key":"9bd1a1637d4f1","_type":"span","marks":["em"],"text":"pull requests"},{"_key":"9bd1a1637d4f2","_type":"span","marks":[],"text":", or requests to merge code from one branch into another. An example of this deployment workflow could look something like this:"}],"markDefs":[],"style":"normal"},{"_key":"7f418f8b75a7","_type":"block","children":[{"_key":"7f418f8b75a70","_type":"span","marks":[],"text":"Engineer forks a copy of the "},{"_key":"7f418f8b75a71","_type":"span","marks":["em"],"text":"modules"},{"_key":"7f418f8b75a72","_type":"span","marks":[],"text":" codebase onto their own account (as they won't have write permission to the parent "},{"_key":"7f418f8b75a73","_type":"span","marks":["em"],"text":"modules"},{"_key":"7f418f8b75a74","_type":"span","marks":[],"text":" repository.)"}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"2b2aebf07d39","_type":"block","children":[{"_key":"2b2aebf07d390","_type":"span","marks":[],"text":"Engineer clones the forked repository that they just created."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"2142f7d8a76a","_type":"block","children":[{"_key":"2142f7d8a76a0","_type":"span","marks":[],"text":"Engineer makes changes to the "},{"_key":"2142f7d8a76a1","_type":"span","marks":["em"],"text":"application_environment"},{"_key":"2142f7d8a76a2","_type":"span","marks":[],"text":" module (to, say, create a "},{"_key":"2142f7d8a76a3","_type":"span","marks":["em"],"text":"CNAME"},{"_key":"2142f7d8a76a4","_type":"span","marks":[],"text":" record alongside an "},{"_key":"2142f7d8a76a5","_type":"span","marks":["em"],"text":"A"},{"_key":"2142f7d8a76a6","_type":"span","marks":[],"text":" record)."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"b48dcb30140e","_type":"block","children":[{"_key":"b48dcb30140e0","_type":"span","marks":[],"text":"Engineer uses "},{"_key":"b48dcb30140e1","_type":"span","marks":["em"],"text":"kitchen-terraform"},{"_key":"b48dcb30140e2","_type":"span","marks":[],"text":" to test the changes locally."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"3767085cc8c2","_type":"block","children":[{"_key":"3767085cc8c20","_type":"span","marks":[],"text":"Engineer commits the change to their fork and pushes it upstream to the server."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"5ca2e0526047","_type":"block","children":[{"_key":"5ca2e05260470","_type":"span","marks":[],"text":"Engineer submits a pull request to merge their fork with its parent."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"a626f9f19d4c","_type":"block","children":[{"_key":"a626f9f19d4c0","_type":"span","marks":[],"text":"Lead engineer and the module maintainer review the request."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"4ffd7d9e22dc","_type":"block","children":[{"_key":"4ffd7d9e22dc0","_type":"span","marks":[],"text":"Lead engineer or the module maintainer approves the request and merges the code."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"53c245bd2eea","_type":"block","children":[{"_key":"53c245bd2eea0","_type":"span","marks":[],"text":"Using this approach does three things for your organization:"}],"markDefs":[],"style":"normal"},{"_key":"d04027b7308c","_type":"block","children":[{"_key":"d04027b7308c0","_type":"span","marks":[],"text":"It establishes the infrastructure code within "},{"_key":"d04027b7308c1","_type":"span","marks":["em"],"text":"master"},{"_key":"d04027b7308c2","_type":"span","marks":[],"text":" as the canonical source of truth for your entire organization's technology,"}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"7a1b5ec281e3","_type":"block","children":[{"_key":"7a1b5ec281e30","_type":"span","marks":[],"text":"It protects that source of truth from being modified without going through a proper review cycle, and"}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"41e1870648c5","_type":"block","children":[{"_key":"41e1870648c50","_type":"span","marks":[],"text":"It removes your engineering team's dependency on change management software to execute simple changes against your infrastructure."}],"level":1,"listItem":"number","markDefs":[],"style":"normal"},{"_key":"4aea3ba609e6","_type":"block","children":[{"_key":"4aea3ba609e60","_type":"span","marks":[],"text":"3. Unifies teams through a single codebase and common languages"}],"markDefs":[],"style":"h2"},{"_key":"fae71c0a483b","_type":"block","children":[{"_key":"fae71c0a483b0","_type":"span","marks":[],"text":"As an engineering manager, you probably do not expect your systems administrators to understand how to configure Juniper routers and switches like your network engineers can. You also probably don't expect your software developers to become systems administrators and configure iptables on their application servers. You hire people to excel at what they're good at."}],"markDefs":[],"style":"normal"},{"_key":"73a4caa0cb1a","_type":"block","children":[{"_key":"73a4caa0cb1a0","_type":"span","marks":[],"text":"However, it is easy to see how this naturally creates knowledge and cultural silos. Software engineers prefer to work with other software engineers, systems administrators prefer to work with other systems administrators, and so on. As an engineering organization grows and becomes more specialized, the proliferation of proverbial lunch tables increases in tandem. Forbes wrote a nice piece on this in 2013 that you can "},{"_key":"73a4caa0cb1a1","_type":"span","marks":["358b4c7f0e0a"],"text":"read here"},{"_key":"73a4caa0cb1a2","_type":"span","marks":[],"text":"."}],"markDefs":[{"_key":"358b4c7f0e0a","_type":"link","href":"https://www.forbes.com/sites/brentgleeson/2013/10/02/the-silo-mentality-how-to-break-down-the-barriers/"}],"style":"normal"},{"_key":"1e4317ad6e21","_type":"block","children":[{"_key":"1e4317ad6e210","_type":"span","marks":[],"text":"One can consider building a tiger team of specialists from different parts of the organization as an attempt to break down these silos. While this is well-intentioned in theory, in practice it often leads to a lot of friction and confusion. Trying to turn the network engineer into a systems administrator without a proper transition plan can lead to that engineer feeling like she just got burdened with an additional job and a whole lot of tickets. I wrote a bit about this a few months ago on my post about "},{"_key":"1e4317ad6e211","_type":"span","marks":["3b091727bbe9"],"text":"Getting Into DevOps"},{"_key":"1e4317ad6e212","_type":"span","marks":[],"text":"."}],"markDefs":[{"_key":"3b091727bbe9","_type":"link","href":"https://www.linkedin.com/pulse/getting-devops-carlos-nunez"}],"style":"normal"},{"_key":"41331092e208","_type":"block","children":[{"_key":"41331092e2080","_type":"span","marks":[],"text":"Terraform and Chef are to groups of co-working engineers what English is to most people: "},{"_key":"41331092e2081","_type":"span","marks":["em"],"text":"the universal lingua franca"},{"_key":"41331092e2082","_type":"span","marks":[],"text":"."}],"markDefs":[],"style":"normal"},{"_key":"999d06e7aae9","_type":"block","children":[{"_key":"999d06e7aae90","_type":"span","marks":[],"text":"Using a common set of languages on which infrastructure code is built allows teams to work together and understand each other in ways that weren't easily possible in the past. Terraform and Chef are particularly good at this in that they both provide a simple and clear "},{"_key":"999d06e7aae91","_type":"span","marks":["em"],"text":"domain specific language"},{"_key":"999d06e7aae92","_type":"span","marks":[],"text":" that is readable by nearly anyone and requires no formal programming background to understand. Subsequently, while the systems administrator doesn't "},{"_key":"999d06e7aae93","_type":"span","marks":["em"],"text":"have"},{"_key":"999d06e7aae94","_type":"span","marks":[],"text":" to understand how to configure a Juniper switch to see how servers get configured on the network, he can now see "},{"_key":"999d06e7aae95","_type":"span","marks":["em"],"text":"how"},{"_key":"999d06e7aae96","_type":"span","marks":[],"text":" it’s done through Terraform configurations, and he can learn more about "},{"_key":"999d06e7aae97","_type":"span","marks":["em"],"text":"why"},{"_key":"999d06e7aae98","_type":"span","marks":[],"text":" it's done that way from finding the authors of that configuration from browsing its commit history."}],"markDefs":[],"style":"normal"},{"_key":"cc9b2cebad44","_type":"block","children":[{"_key":"cc9b2cebad440","_type":"span","marks":[],"text":"Make Your Job Easier"}],"markDefs":[],"style":"normal"},{"_key":"df8adeaeacf6","_type":"block","children":[{"_key":"df8adeaeacf60","_type":"span","marks":[],"text":"To return to the scenario we posited at the beginning: you have a difficult job as an engineering manager of an airline. In this context, infrastructure as code makes your job easier."}],"markDefs":[],"style":"normal"},{"_key":"b3fa3a1fadaf","_type":"block","children":[{"_key":"b3fa3a1fadaf0","_type":"span","marks":[],"text":"Instead of your engineers relying on slow change approvals, broken documentation and living in fear of change, they can rely on a single-source-of-truth codebase that has been tested and vetted through unit and integration tests and can be modified and experimented with at any time through repository forking. No longer do your engineers have to fear production, in fact, they can use infrastructure as code to run an "},{"_key":"b3fa3a1fadaf1","_type":"span","marks":["em"],"text":"exact"},{"_key":"b3fa3a1fadaf2","_type":"span","marks":[],"text":" replica of production (albeit smaller) right on their workstations. No longer do your software developers have to \"blame IT\" for being unable to release features to production, they can create environments themselves whenever they need to and run nearly full-scale integration tests without impacting customer workloads."}],"markDefs":[],"style":"normal"},{"_key":"41d4d608a3f8","_type":"block","children":[{"_key":"41d4d608a3f80","_type":"span","marks":[],"text":"Ultimately, the goal of DevOps is to make your company a software-first company. Infrastructure as code gets your airline a big step closer to that goal."}],"markDefs":[],"style":"normal"},{"_key":"e2009014e2de","_type":"block","children":[{"_key":"e2009014e2de0","_type":"span","marks":[],"text":"Your passengers and customers will thank you for it!"}],"markDefs":[],"style":"normal"}],"author":{"name":"Carlos Nunez","image":{"alt":"Carlos Nunez","asset":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAQABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAYHCP/EACIQAAEDBAICAwAAAAAAAAAAAAECAwQABQYRBxJRYSExQf/EABcBAAMBAAAAAAAAAAAAAAAAAAECAwT/xAAZEQADAQEBAAAAAAAAAAAAAAAAAQIDITH/2gAMAwEAAhEDEQA/ALdk8pyLY33GO3b4G0/YFIuE3R85s5GYVIMRxkqWlw7CVeaTOa+RrhAu6rDbylpkJSXlkbKt/lT/AB3k6bY8rE5DSHopQGnEga7J8j3RrK3oqXg8awsqlrpr5xQ7UUu2TIIt9tce4Ql9mXk7Hr1RVjMf/9k=","aspectRatio":1.25,"src":"https://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=80&h=64&fit=crop","srcSet":"https://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=120&h=96&fit=crop 120w,\nhttps://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=160&h=128&fit=crop 160w,\nhttps://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=240&h=192&fit=crop 240w,\nhttps://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg 5020w","srcWebp":"https://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=80&h=64&fit=crop&fm=webp","srcSetWebp":"https://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=120&h=96&fit=crop&fm=webp 120w,\nhttps://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=160&h=128&fit=crop&fm=webp 160w,\nhttps://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?w=240&h=192&fit=crop&fm=webp 240w,\nhttps://cdn.sanity.io/images/hgftikht/production/e3c77a443c38f448b1834df6d91659509140abe0-5020x4016.jpg?fm=webp 5020w","sizes":"(max-width: 80px) 100vw, 80px"}}}}},"moreArticles":[{"title":"Intro to AWS Blox: An Open Source Container Scheduler for ECS","slug":{"current":"intro-to-aws-blox-an-open-source-container-scheduler-for-ecs"},"publishedAt":"30 May 2017","heroImage":{"alt":"Intro to AWS Blox: An Open Source Container Scheduler for ECS","asset":{"fluid":{"aspectRatio":1.4754098360655739,"src":"https://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=630&h=427&fit=crop","srcSet":"https://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=158&h=107&fit=crop 158w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=315&h=214&fit=crop 315w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=630&h=427&fit=crop 630w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=945&h=641&fit=crop 945w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=1000&h=678&fit=crop 1000w","srcWebp":"https://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=630&h=427&fit=crop&fm=webp","srcSetWebp":"https://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=158&h=107&fit=crop&fm=webp 158w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=315&h=214&fit=crop&fm=webp 315w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=630&h=427&fit=crop&fm=webp 630w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=945&h=641&fit=crop&fm=webp 945w,\nhttps://cdn.sanity.io/images/hgftikht/production/f98c228cc35d1172551142138d2dc8376500506d-1000x665.jpg?w=1000&h=678&fit=crop&fm=webp 1000w","sizes":"(max-width: 630px) 100vw, 630px"}}},"author":{"name":"Jesse White","image":null}},{"title":"Shifting Compliance Left: Improving Regulatory Reporting for Investment Banks with DevOps","slug":{"current":"shifting-compliance-left-improving-regulatory-reporting-for-investment-banks-with-devops"},"publishedAt":"25 May 2017","heroImage":{"alt":"Shifting Compliance Left: Improving Regulatory Reporting for Investment Banks with DevOps","asset":{"fluid":{"aspectRatio":1.4754098360655739,"src":"https://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=630&h=427&fit=crop","srcSet":"https://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=158&h=107&fit=crop 158w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=315&h=214&fit=crop 315w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=630&h=427&fit=crop 630w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=945&h=641&fit=crop 945w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=1000&h=678&fit=crop 1000w","srcWebp":"https://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=630&h=427&fit=crop&fm=webp","srcSetWebp":"https://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=158&h=107&fit=crop&fm=webp 158w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=315&h=214&fit=crop&fm=webp 315w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=630&h=427&fit=crop&fm=webp 630w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=945&h=641&fit=crop&fm=webp 945w,\nhttps://cdn.sanity.io/images/hgftikht/production/41b30d359f39e9828a127ad0876ba369b935c79a-1000x666.jpg?w=1000&h=678&fit=crop&fm=webp 1000w","sizes":"(max-width: 630px) 100vw, 630px"}}},"author":{"name":"Emre Erkunt","image":null}},{"title":"An Introduction to Serverless Computing with AWS Lambda","slug":{"current":"download-our-new-paper-on-serverless-computing-with-aws-lambda"},"publishedAt":"23 May 2017","heroImage":{"alt":"An Introduction to Serverless Computing with AWS Lambda","asset":{"fluid":{"aspectRatio":1.4754098360655739,"src":"https://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=630&h=427&fit=crop","srcSet":"https://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=158&h=107&fit=crop 158w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=315&h=214&fit=crop 315w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=630&h=427&fit=crop 630w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=945&h=641&fit=crop 945w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=1200&h=813&fit=crop 1200w","srcWebp":"https://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=630&h=427&fit=crop&fm=webp","srcSetWebp":"https://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=158&h=107&fit=crop&fm=webp 158w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=315&h=214&fit=crop&fm=webp 315w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=630&h=427&fit=crop&fm=webp 630w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=945&h=641&fit=crop&fm=webp 945w,\nhttps://cdn.sanity.io/images/hgftikht/production/a25261db76eed4e23de5496637d269e607031fc2-1200x800.jpg?w=1200&h=813&fit=crop&fm=webp 1200w","sizes":"(max-width: 630px) 100vw, 630px"}}},"author":{"name":"Henry Bell","image":null}}],"sanityPage":{"slug":{"current":"insights"},"blocks":[{"__typename":"SanitySignupBlock","_key":"bcb83330a70e","_type":"signupBlock","component":"module---src-components-blocks-signup-block-index-js-default-","reference":{"title":"Sign-up: Insights Directly to Your Inbox","subtitle":"Join tens of thousands of your peers and sign-up for our best content and industry commentary, curated by our experts.","successMessage":"Thanks for signing-up!","submitBtn":"Subscribe","marketoSnippet":"<script src=\"https://www10.contino.io/js/forms2/js/forms2.min.js\"></script><form id=\"mktoForm_1126\"></form>   <script>    MktoForms2.setOptions({formXDPath : \"/rs/964-BIK-421/images/marketo-xdframe-relative.html\"});    MktoForms2.loadForm(\"//www10.contino.io\", \"964-BIK-421\", 1126);   </script>"}}]}},"pageContext":{"sanityId":"48b87108-cea6-4934-8e17-7ee122a47cc0"}},"staticQueryHashes":["2919194494","3157258374","3449559901"],"moduleDependencies":["module---src-components-blocks-signup-block-index-js-default-"]}